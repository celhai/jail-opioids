---
title: "R Notebook"
output: html_notebook
---

```{r}
library(deSolve)
library(ggplot2)
model = function(pop, world, jail, sition, dead, betaWJ, betaJT, betaTW, betaTD, betaWD, betaWO, betaJO, betaOW) {
  deadW = 0
  deadT = 0
  times = seq(0, 365, by = 0.1)
  
  out <- ode(y = c(pop, world, jail, sition, dead, deadW, deadT), times = times, func = plonk, parms = c(betaWJ, betaJT, betaTW, betaTD, betaWD, betaWO, betaJO, betaWO))
  print(out[,8])
  plot(times, out[,8]/out[,7], xlab = "Days", ylab = "Ratio", type = 'l', ylim = c(0, 150), col="royalblue")
  legend(30, 10, legend=c("Population","World", "Jail", "Transition", "Dead"), col=c("royalblue", "purple", "red", "pink", "orange"), lty=1, cex=0.8)
  }
model(5100000, 5000000, 100000, 0, 0, 1/14, .01, .01, .0001*130, .0001, .1, .1, .1)

```

```{r}
worldJail = function(pop, world, beta) {
  return (beta*world/pop)
}
jailSition = function(pop, jail, beta) {
  return (beta*jail/pop)
}
sitionWorld = function(pop, sition, beta) {
  return (beta*sition)/pop
}
sitionDead = function(pop, sition, beta) {
  return (beta*sition)/pop
}
worldDead = function(pop, world, beta) {
  return (beta*world)/pop
}
worldOut = function(pop, world, beta) {
  return (beta*world)/pop
}
jailOut = function(pop, jail, beta) {
  return (beta*jail)/pop
}
outWorld = function(pop, world, beta) {
  return (beta*world)/pop
}
plonk <- function(t, state, parameters) {
with(as.list(c(state, parameters)),{
# rate of change
dWorldJail <- worldJail(state[1], state[2], parameters[1])
dJailSition <- jailSition(state[1], state[3], parameters[2])
dSitionWorld <- jailSition(state[1], state[4], parameters[3])
dSitionDead <- sitionDead(state[1], state[4], parameters[4])
dWorldDead <- worldDead(state[1], state[2], parameters[5])
dWorldOut <- worldOut(state[1], state[2], parameters[6])
dJailOut <- worldOut(state[1], state[3], parameters[7])
dOutWorld <- worldOut(state[1], state[2], parameters[8])
# return the rate of change
list(c(dOutWorld-(dWorldOut+dJailOut), dOutWorld+dSitionWorld-dWorldJail-dWorldDead-dWorldOut, dWorldJail-dJailSition-dJailOut, dJailSition-dSitionWorld-dSitionDead, dWorldDead+dSitionDead,dWorldDead/state[2], dSitionDead/state[4]))
}) # end with(as.list ...
}
```